<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet type=text/css href=../../css/style.css><link rel=stylesheet type=text/css href=../../css/page-layouts/content-header.css><link rel=stylesheet type=text/css href=../../css/sidebar/style.css><link rel=stylesheet type=text/css href=../../css/page-layouts/style.css><link rel=stylesheet type=text/css href=../../css/page-layouts/syntax.css><link rel=stylesheet type=text/css href=../../css/tabs/style.css><link rel=stylesheet type=text/css href=../../css/bootstrap.min.css><link rel=stylesheet type=text/css href=../../override/style.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Poppins"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Source%20Code%20Pro"><link rel=stylesheet href=../../feather-icons/css/iconfont.css><link rel=icon href=../../images/favicon.ico type=image/x-icon><style>:root{--white: #ffffff;--primary: #fff;--secondary: #1E1F21;--sidebar-bg: #f6f6f8;--sidebar-primary: #1E1F21;--accent: #e34a3a;--grey100: ;--grey200: #F9F9FA;--grey300: ;--grey400: ;--grey500: ;--grey600: #1E1F21;--grey700: ;--grey800: ;--grey900: ;--grey-head: #EFEFF3;--nav-highlight: ;--body-font: Roboto;--heading-font: Poppins;--code-font: Source Code Pro}</style><title>Data Connect | Use Existing Data</title></head><body><!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet type=text/css href=../../css/style.css><link rel=stylesheet type=text/css href=../../css/page-layouts/content-header.css><link rel=stylesheet type=text/css href=../../css/sidebar/style.css><link rel=stylesheet type=text/css href=../../css/page-layouts/style.css><link rel=stylesheet type=text/css href=../../css/page-layouts/syntax.css><link rel=stylesheet type=text/css href=../../css/tabs/style.css><link rel=stylesheet type=text/css href=../../css/bootstrap.min.css><link rel=stylesheet type=text/css href=../../override/style.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Poppins"><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Source%20Code%20Pro"><link rel=stylesheet href=../../feather-icons/css/iconfont.css><link rel=icon href=../../images/favicon.ico type=image/x-icon><style>:root{--white: #ffffff;--primary: #fff;--secondary: #1E1F21;--sidebar-bg: #f6f6f8;--sidebar-primary: #1E1F21;--accent: #e34a3a;--grey100: ;--grey200: #F9F9FA;--grey300: ;--grey400: ;--grey500: ;--grey600: #1E1F21;--grey700: ;--grey800: ;--grey900: ;--grey-head: #EFEFF3;--nav-highlight: ;--body-font: Roboto;--heading-font: Poppins;--code-font: Source Code Pro}</style><title>Data Connect | Tables-in-a-bucket Method</title></head><body><div class=sidebar id=sidebar-nav><button id=logo-collapse-btn onclick="(function(){document.getElementById('sidebar-nav').classList.toggle('show');document.getElementById('content').classList.toggle('showing-nav')})()">
<img id=logo src=../../images/logo.png alt="Data Connect"><div class=site-title><h3 class=sidebar-h1>Data Connect</h3></div></button><div class="card sidebar-card"><div class=collapse-header><a class=nav-link href=../../docs/getting-started/><i class="icon-layers navicon"></i><h3 class="sidebar-h1 mainitem">Quick Start</h3></a></div><div class=collapse><div class=nav-list><a class=nav-link href=../../docs/getting-started/introduction/><h3 class="sidebar-h2 subitem">Introduction</h3></a><a class=nav-link href=../../docs/getting-started/clients/><h3 class="sidebar-h2 subitem">Install Clients</h3></a><a class=nav-link href=../../docs/getting-started/provision-data/><h3 class="sidebar-h2 subitem">Provision Data</h3></a><a class=nav-link href=../../docs/getting-started/consume-data/><h3 class="sidebar-h2 subitem">Consume Data</h3></a></div></div><div class=collapse-header><a class=nav-link href=../../docs/use-exisitng-data/><i class="icon-database navicon"></i><h3 class="sidebar-h1 mainitem">Use Existing Data</h3></a></div><div class="collapse show"><div class=nav-list><a class=nav-link href=../../docs/use-exisitng-data/tables-in-a-bucket/doc/><h3 class="sidebar-h2 nav-highlight subitem" id=scrollto>Tables-in-a-bucket Method</h3></a><a class=nav-link href=../../docs/use-exisitng-data/using-trino/doc/><h3 class="sidebar-h2 subitem">Using Trino</h3></a></div></div><div class=collapse-header><a class=nav-link href=../../docs/security/><i class="icon-shield navicon"></i><h3 class="sidebar-h1 mainitem">Security</h3></a></div><div class=collapse><div class=nav-list><a class=nav-link href=../../docs/security/data-source/><h3 class="sidebar-h2 subitem">At Data Sources</h3></a><a class=nav-link href=../../docs/security/search-endpoint/><h3 class="sidebar-h2 subitem">At Endpoints</h3></a></div></div><div class=collapse-header><a class=nav-link href=../../docs/reference/><i class="icon-book navicon"></i><h3 class="sidebar-h1 mainitem">Implementation</h3></a></div><div class=collapse><div class=nav-list><a class=nav-link href=../../docs/reference/pagination-long-queries/><h3 class="sidebar-h2 subitem">Pagination and Long Running Queries</h3></a><a class=nav-link href=../../docs/reference/sql-functions/><h3 class="sidebar-h2 subitem">SQL Functions</h3></a><a class=nav-link href=../../docs/reference/sql-grammar/><h3 class="sidebar-h2 subitem">SQL Grammar</h3></a></div></div></div><div class=footer-container></div></div><button id=sidebar-btn onclick="(function(){document.getElementById('sidebar-nav').classList.toggle('show');document.getElementById('content').classList.toggle('showing-nav')})()">
<i class="icon-menu mobile"></i></button><div class=content id=content><div class=content-header><div id=search-input-div><button class=search-button id=search-button data-toggle=modal data-target=#search-input-modal><h3 class=search-button-text><i class="icon-search search-icon"></i>Find anything</h3></button><div class="modal search" id=search-input-modal><div id=search-input-modal class=modal-dialog><div id=search-input-div class=modal-content><input id=search-input type=text placeholder name=search autocomplete=off>
<span class=focus-border></span><section id=search-results class=search></section></div></div></div></div><div class=content-header-nav><a class=content-header-nav-link href=../../api><i class=icon-code></i><span class=top-nav-text>API</span></a>
<a class=content-header-nav-link href=https://github.com/ga4gh-discovery/data-connect/blob/develop/SPEC.md><i class=icon-file-text></i><span class=top-nav-text>Specification</span></a>
<a class=content-header-nav-link href=https://github.com/ga4gh-discovery/data-connect/><i class=icon-github></i><span class=top-nav-text>Github</span></a></div></div><div class=text-area><h2>Tables-in-a-bucket Method</h2><h4 id=what-is-a-phenopacket>What is a Phenopacket?</h4><p>Phenopacket is a GA4GH approved standard file format for sharing phenotypic information.</p><p>Find <a href=https://phenopackets-schema.readthedocs.io/en/latest/>documentation for phenopackets-schema</a> here.</p><h4 id=whats-in-a-phenopacket>What&rsquo;s in a Phenopacket?</h4><ul><li>A set of mandatory and optional fields to share information about a patient or participantâ€™s phenotype</li><li>Optional fields may include clinical diagnosis, age of onset, results from lab tests, and disease severity.</li></ul><p>An example of the JSON structure can be found <a href=https://schemablocks.org/schemas/sb-phenopackets/current/Phenopacket.json>here</a>.</p><h4 id=preparing-the-data-for-a-data-connect-application>Preparing the Data for a Data Connect Application</h4><p>If you need some phenopackets data to follow this example, consider the following:</p><ul><li>Human Phenotype Ontology phenopackets downloaded from a publicly available metadata source: <a href=https://zenodo.org/record/3905420#.X3Sd2pNKj6h>https://zenodo.org/record/3905420#.X3Sd2pNKj6h</a>.</li><li>Gecco Biosample phenopackets.</li></ul><ol><li>Clone this repository: <code>https://github.com/DNAstack/tables-loader</code></li><li>All phenopacket JSON files should be added under &lt;repo_root>/resources/phenopackets</li><li>Create a Google storage bucket with public access. <a href=https://cloud.google.com/storage/docs/creating-buckets>Creating Storage Buckets</a></li><li>Create a service account and grant &ldquo;Storage Admin&rdquo; access to your storage bucket. You should automatically begin downloading the access key. <strong>Store this access key somewhere safe. You&rsquo;ll need it later.</strong></li></ol><h4 id=running-the-spring-application>Running the Spring Application</h4><ol><li>Export this environment variable: <code>GOOGLE_APPLICATION_CREDENTIALS=&lt;service_account_json_file_path></code></li><li>Start the Spring application. (With your Java IDE or <code>mvn clean spring-boot:run</code> in bash)</li><li>You should see the following at <code>http://localhost:8080/</code>: <code>Welcome to Phenopackets tables loader application!</code></li></ol><h4 id=available-api-endpoints>Available API Endpoints</h4><p><code>/create-tables-files/{tableStructure}</code>
Creates tables, info and data files for all phenopackets JSON present in &lt;repo_root>/resources/phenopackets directory</p><p><code>/upload-files/{tableStructure}</code>
Uploads all files under &lt;repo_root>/resources/ga4gh-phenopackets-example/&lt;by_subject|flat> to Google Cloud Storage bucket ga4gh-phenopackets-example</p><p><code>phenopacket/{tableStructure}/tables</code>
Gets &lt;repo_root>/resources/ga4gh-phenopackets-example/&lt;by_subject|flat>/tables json file</p><p><code>phenopacket/{tableStructure}/table/{tableName}/info</code>
Gets &lt;repo_root>/resources/ga4gh-phenopackets-example/&lt;by_subject|flat>/table/info file</p><p><code>phenopacket/{tableStructure}/table/{tableName}/data</code>
Gets &lt;repo_root>/resources/ga4gh-phenopackets-example/&lt;by_subject|flat>/table/data file</p><div class=footer-root><div class=footer-prev></div><div class=footer-nav><a class=content-header-nav-link href=../../api><i class=icon-code></i></a><a class=content-header-nav-link href=https://github.com/ga4gh-discovery/data-connect/blob/develop/SPEC.md><i class=icon-file-text></i></a><a class=content-header-nav-link href=https://github.com/ga4gh-discovery/data-connect/><i class=icon-github></i></a></div><div class=footer-next><a class=content-header-nav-link href=../../docs/use-exisitng-data/using-trino/doc/><i class=icon-arrow-right></i></a></div></div></div></div><script src=../../js/jquery-3.5.1.min.js></script><script src=../../js/bootstrap.min.js></script><script src=https://unpkg.com/lunr/lunr.js></script><script>document.getElementById("scrollto").scrollIntoView(true);</script><script type=text/javascript>var idx,searchInput,searchResults=null
var documents=[]
function renderSearchResults(results){if(results.length>0){if(results.length>9){results=results.slice(0,10)}
searchResults.innerHTML=''
results.forEach(result=>{var article=document.createElement('article')
var uri="/data-connect"+result.ref.replace("/index.json","")
article.innerHTML=`
            <a href="${uri}" class="search-result-item"><p class="search-result-title">${documents[result.ref].title}</p> <i class="icon-external-link"></i></a>
            `
searchResults.appendChild(article)})}else{searchResults.innerHTML='<p>No results found.</p>'}}
function registerSearchHandler(){searchInput.oninput=function(event){if(searchInput.value==''){searchResults.innerHTML=''}else{var query=event.target.value
var results=idx.search(query+'*')
renderSearchResults(results)}}
searchInput.focus()
searchInput.placeholder=''}
$('#search-input-modal').on('shown.bs.modal',function(){$('#search-input').trigger('focus')})
window.onload=function(){searchInput=document.getElementById('search-input')
searchResults=document.getElementById('search-results')
fetch('/data-connect/index.json',{method:'get'}).then(res=>res.json()).then(res=>{idx=lunr(function(){this.ref('url')
this.field('title')
this.field('content')
res.forEach(function(doc){this.add(doc)
documents[doc.url]={'title':doc.title,'content':doc.content,}},this)})
registerSearchHandler()}).catch(err=>{searchResults.innerHTML=`<p>${err}</p>`})}</script></body></html><script src=../../js/jquery-3.5.1.min.js></script><script src=../../js/bootstrap.min.js></script><script src=https://unpkg.com/lunr/lunr.js></script><script>document.getElementById("scrollto").scrollIntoView(true);</script><script type=text/javascript>var idx,searchInput,searchResults=null
var documents=[]
function renderSearchResults(results){if(results.length>0){if(results.length>9){results=results.slice(0,10)}
searchResults.innerHTML=''
results.forEach(result=>{var article=document.createElement('article')
var uri="/data-connect"+result.ref.replace("/index.json","")
article.innerHTML=`
            <a href="${uri}" class="search-result-item"><p class="search-result-title">${documents[result.ref].title}</p> <i class="icon-external-link"></i></a>
            `
searchResults.appendChild(article)})}else{searchResults.innerHTML='<p>No results found.</p>'}}
function registerSearchHandler(){searchInput.oninput=function(event){if(searchInput.value==''){searchResults.innerHTML=''}else{var query=event.target.value
var results=idx.search(query+'*')
renderSearchResults(results)}}
searchInput.focus()
searchInput.placeholder=''}
$('#search-input-modal').on('shown.bs.modal',function(){$('#search-input').trigger('focus')})
window.onload=function(){searchInput=document.getElementById('search-input')
searchResults=document.getElementById('search-results')
fetch('/data-connect/index.json',{method:'get'}).then(res=>res.json()).then(res=>{idx=lunr(function(){this.ref('url')
this.field('title')
this.field('content')
res.forEach(function(doc){this.add(doc)
documents[doc.url]={'title':doc.title,'content':doc.content,}},this)})
registerSearchHandler()}).catch(err=>{searchResults.innerHTML=`<p>${err}</p>`})}</script></body></html>